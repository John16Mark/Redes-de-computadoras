#include <stdio.h>
#include <stdlib.h>

typedef unsigned char byte;

int main() {
    /*byte T[] = {
        0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x08, 0x06, 0x00, 0x01,
        0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x01, 0x00, 0x00, 0x01,
        0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };*/
    byte T[] = {
		0x00, 0x01, 0x63, 0x7D, 0x81, 0x38, 0x00, 0x0A, 0xF3, 0x35, 0x68, 0x02, 0x08, 0x06, 0x00, 0x01, 
		0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x00, 0x0A, 0xF3, 0x35, 0x68, 0x02, 0xC8, 0x01, 0x01, 0x02, 
		0x00, 0x01, 0x63, 0x7D, 0x81, 0x38, 0xC8, 0x01, 0x01, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    if((T[12]<<8|T[13]) != 2054) {
        printf("La trama no es ARP");
        exit(0);
    }

    printf("\033[92mProtocolo ARP\033[0m\n", 162);
    printf("\033[94mHardware Addess Type:\033[0m\n  ");
    if((T[14]<<8|T[15]) == 1) {
        printf("Ethernet\n");
    } else if((T[14]<<8|T[15]) == 6) {
        printf("IEEE 802 LAN\n");
    } else {
        printf("Otro\n");
    }

    printf("\033[94mProtocol Addess Type:\033[0m\n  ");
    if((T[16]<<8|T[17]) == 2048) {
        printf("IPv4 (0x0800)\n");
    } else {
        printf("Otro\n");
    }

    printf("\033[94mHardware Address Length:\033[0m\n  %d bytes\n", T[18]);
    printf("\033[94mProtocol Address Length:\033[0m\n  %d bytes\n", T[19]);
    printf("\033[94mProtocol Addess Type:\033[0m\n  ");
    if((T[20]<<8|T[21]) == 1) {
        printf("Solicitud\n");
    } else if ((T[20]<<8|T[21]) == 2) {
        printf("Respuesta\n");
    }
    printf("\033[94mSource Hardware Address:\033[0m\n  %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[22], T[23], T[24], T[25], T[26], T[27]);
    printf("\033[94mSource Protocol Address:\033[0m\n  %d.%d.%d.%d\n", T[28], T[29], T[30], T[31]);
    printf("\033[94mTarget Hardware Address:\033[0m\n  %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n", T[32], T[33], T[34], T[35], T[36], T[37]);
    printf("\033[94mTarget Protocol Address:\033[0m\n  %d.%d.%d.%d\n", T[38], T[39], T[40], T[41]);
    return 0;
}